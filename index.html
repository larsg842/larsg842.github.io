<!doctype html>
<html lang="de">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Persönliche Startseite — Lars G.</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <style>
        :root{
            --bg:#ffffff;
            --text:#0b1220;
            --muted:#46515b;
            --accent:#20b581ff;
            --card:#f7f9fb;
            --radius:12px;
            --card-shadow: 0 14px 32px rgba(32,181,129,0.08);
            --max-width:1000px;
            --gap:1.5rem;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, system-ui, sans-serif;
            color-scheme: light;
        }

        /* Nachtmodus-Variablen */
        .dark{
            --bg:#0b1220;
            --text:#e6eef6;
            --muted:#98a9b8;
            --accent:#2ad48bff;
            --card:#0f1620;
            --card-shadow: 0 14px 36px rgba(0,0,0,0.6);
            color-scheme: dark;
        }

        /* sanfte Übergänge bei Farbwechsel */
        html, body, .card, table, .card-content, header, footer {
            transition: background-color .24s ease, color .24s ease, box-shadow .24s ease;
        }

        html,body{
            height:100%;
            margin:0;
            background:var(--bg);
            color:var(--text);
            -webkit-font-smoothing:antialiased;
            -moz-osx-font-smoothing:grayscale;
            line-height:1.6;
        }

        .wrap{
            max-width:var(--max-width);
            margin:3rem auto;
            padding:1rem;
            box-sizing:border-box;
        }

        header{
            display:block;
            margin-bottom:2.25rem;
            text-align:left;
            position:relative; /* erlaubt Positionierung des Toggle-Buttons */
        }

        h1{
            margin:0 0 .6rem 0;
            font-size:clamp(1.4rem, 2.6vw, 2rem);
            line-height:1.05;
        }

        .lead{
            margin:0 0 .75rem 0;
            color:var(--muted);
            font-size:1rem;
        }

        main{
            display:grid;
            gap:var(--gap);
        }

        section.timeline{
            background:linear-gradient(180deg, rgba(32,181,129,0.03), transparent);
            padding:1rem;
            border-radius:var(--radius);
        }

        .table-wrap{
            overflow:auto;
            border-radius:8px;
            box-shadow:0 1px 0 rgba(0,0,0,0.04) inset;
            margin-top:.9rem;
        }

        table{ width:100%; border-collapse:collapse; min-width:640px; }
        caption{ text-align:left; font-size:.95rem; font-weight:600; margin-bottom:.45rem; color:var(--text); }
        thead th{ text-align:left; font-size:.9rem; padding:.75rem; background:transparent; color:var(--muted); border-bottom:2px solid rgba(32,181,129,0.08); }
        tbody td{ padding:.85rem; border-bottom:1px solid rgba(15,20,25,0.04); font-size:.97rem; line-height:1.5; }

        section.gallery{ padding:0; }

        .cards{ display:grid; gap:var(--gap); grid-template-columns:repeat(1,1fr); margin-top:.9rem; }

        .card{ display:flex; flex-direction:column; background:var(--card); border-radius:var(--radius); overflow:hidden; text-decoration:none; color:inherit; transition:transform .18s ease, box-shadow .18s ease; min-height:180px; box-shadow:var(--card-shadow); border:1px solid rgba(10,20,30,0.03); }
        .card:focus, .card:hover{ transform:translateY(-8px); box-shadow:0 28px 56px rgba(32,181,129,0.12); outline:3px solid rgba(32,181,129,0.12); }
        .card-content{ padding: 1rem; }
        .card h3{ margin:0 0 .45rem 0; font-size:1rem; }
        .card p{ margin:0; color:var(--muted); font-size:.95rem; line-height:1.45; }

        footer{ margin-top:1.5rem; font-size:.9rem; color:var(--muted); }

        /* Karte-spezifisch */
        .map-card .map { width:100%; height:200px; }

        /* Tabs */
        .tabs { margin: 1rem 0 0 0; }
        .tablist { display:flex; gap:.5rem; align-items:center; flex-wrap:wrap; }
        .tab { background:var(--card); color:var(--text); border:1px solid rgba(10,20,30,0.06); padding:.45rem .75rem; border-radius:10px; cursor:pointer; font-size:.95rem; }
        .tab[aria-selected="true"] { box-shadow: 0 8px 20px rgba(32,181,129,0.08); outline:3px solid rgba(32,181,129,0.08); }
        .tabpanel { margin-top:.75rem; padding:1rem; background:var(--card); border-radius:12px; box-shadow:var(--card-shadow); }

        a:focus{ outline:3px dashed rgba(32,181,129,0.18); outline-offset:3px; }

        /* Theme-Toggle Button */
        .theme-toggle{ position:absolute; top:0.15rem; right:0; background:transparent; border:1px solid rgba(10,20,30,0.06); background-color:var(--card); color:var(--text); padding:.35rem .6rem; border-radius:10px; cursor:pointer; font-size:.9rem; display:inline-flex; gap:.5rem; align-items:center; }
        .theme-toggle:focus{ outline:3px solid rgba(32,181,129,0.12); outline-offset:3px; }
        .theme-toggle[data-mode="dark"]{ box-shadow:0 6px 18px rgba(0,0,0,0.35); border-color:rgba(255,255,255,0.06); }

        @media (min-width:721px){ .cards{ grid-template-columns:repeat(2,1fr); } }
        @media (min-width:920px){ .cards{ grid-template-columns:repeat(3,1fr); } main{ gap:1.75rem; } }
    </style>
</head>
<body>
    <div class="wrap">
        <header>
            <h1>Lars Grasmück — Geoinformatik &amp; Vermessung</h1>
            <p class="lead">Kurzprofil: Ich absolviere ein Duales Studium der Geoinformatik und Vermessung in Frankfurt und Mainz. Nebenher reise ich gerne und interessiere mich u.a. für Fußball und Tischtennis</p>

            <!-- Theme Toggle Button -->
            <button class="theme-toggle" id="theme-toggle" aria-label="Design umschalten" data-mode="light" title="Design umschalten" aria-pressed="false">🌙 Dunkel</button>
        </header>

        <!-- Statisches, zugängliches Tab-Interface -->
        <div class="tabs" aria-hidden="false">
            <div role="tablist" aria-label="Hauptbereiche" class="tablist">
                <button class="tab" role="tab" id="tab-about-btn" aria-controls="tab-about" aria-selected="true" data-index="0">About</button>
                <button class="tab" role="tab" id="tab-news-btn" aria-controls="tab-news" aria-selected="false" data-index="1">News</button>
                <button class="tab" role="tab" id="tab-projects-btn" aria-controls="tab-projects" aria-selected="false" data-index="2">Projects</button>
            </div>
        </div>

        <main>
            <section id="tab-about" class="tabpanel" role="tabpanel" aria-labelledby="tab-about-btn">
                <section class="timeline" aria-labelledby="timeline-title">
                    <h2 id="timeline-title" style="margin:0;font-size:1rem;">Stationen</h2>
                    <div class="table-wrap" role="region" aria-label="Berufliche Stationen" style="margin-top:.6rem;">
                        <table>
                            <caption>Meine Stationen</caption>
                            <thead>
                                <tr>
                                    <th scope="col">Jahr</th>
                                    <th scope="col">Station</th>
                                    <th scope="col">Ort</th>
                                    <th scope="col">Stichwort</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>2023–heute</td>
                                    <td>Studium</td>
                                    <td>Mainz</td>
                                    <td>Geoinformatik und Vermessung</td>
                                </tr>
                                <tr>
                                    <td>2023–heute</td>
                                    <td>Duales Studium</td>
                                    <td>Frankfurt</td>
                                    <td>Datenmanagement</td>
                                </tr>
                                <tr>
                                    <td>2014–2023</td>
                                    <td>Schule</td>
                                    <td>Hanau</td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Karten als Karten-Artikel -->
                    <div class="cards" style="margin-top:1rem;">
                        <article class="card map-card" role="group" aria-labelledby="map-mainz-title">
                            <div id="map-mainz" class="map" aria-label="Karte Mainz"></div>
                            <div class="card-content">
                                <h3 id="map-mainz-title">Mainz</h3>
                                <p>Standort: Mainz — Studium (Geoinformatik &amp; Vermessung)</p>
                            </div>
                        </article>

                        <article class="card map-card" role="group" aria-labelledby="map-frankfurt-title">
                            <div id="map-frankfurt" class="map" aria-label="Karte Frankfurt"></div>
                            <div class="card-content">
                                <h3 id="map-frankfurt-title">Frankfurt</h3>
                                <p>Standort: Frankfurt — Duales Studium / Datenmanagement</p>
                            </div>
                        </article>

                        <article class="card map-card" role="group" aria-labelledby="map-hanau-title">
                            <div id="map-hanau" class="map" aria-label="Karte Hanau"></div>
                            <div class="card-content">
                                <h3 id="map-hanau-title">Hanau</h3>
                                <p>Standort: Hanau — Schule</p>
                            </div>
                        </article>
                    </div>
                </section>
            </section>

            <section id="tab-news" class="tabpanel" role="tabpanel" aria-labelledby="tab-news-btn" hidden>
                <div class="tabpanel">
                    <h2 style="margin-top:0;margin-bottom:.5rem;font-size:1.05rem;">News</h2>
                    <div id="news-list" class="cards" aria-live="polite" style="margin-top:.6rem;">
                        <!-- News werden hier dynamisch aus assets/news.json geladen -->
                    </div>
                    <noscript style="color:var(--muted);">Bitte aktiviere JavaScript, um die aktuellen Meldungen zu sehen.</noscript>
                </div>
            </section>

            <section id="tab-projects" class="tabpanel" role="tabpanel" aria-labelledby="tab-projects-btn" hidden>
                <div class="tabpanel">
                    <h2 style="margin-top:0;margin-bottom:.5rem;font-size:1.05rem;">Projects</h2>
                    <p style="margin:0;color:var(--muted);">Aktuelle Projekte: —</p>
                </div>
            </section>

        </main>

        <footer>
            <p>&copy; Lars Grasmück</p>
        </footer>
    </div>

    <!-- Leaflet JS (einmalig) -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
    // Karten- und UI-Initialisierung
    document.addEventListener('DOMContentLoaded', function () {
        // Tabs: einfaches, zugängliches Verhalten
        (function initTabs() {
            var tabs = document.querySelectorAll('[role="tab"]');
            var panels = document.querySelectorAll('[role="tabpanel"]');
            var storageKey = 'active-tab-index';

            function activate(index, setFocus) {
                tabs.forEach(function (t, i) {
                    var selected = i === index;
                    t.setAttribute('aria-selected', selected ? 'true' : 'false');
                });
                panels.forEach(function (p, i) {
                    var visible = i === index;
                    p.hidden = !visible;
                    p.setAttribute('aria-hidden', (!visible).toString());
                });
                try { localStorage.setItem(storageKey, String(index)); } catch (e) {}
            }

            tabs.forEach(function (t, i) {
                t.addEventListener('click', function () { activate(i, true); });
                t.addEventListener('keydown', function (e) {
                    var idx = Array.prototype.indexOf.call(tabs, t);
                    if (e.key === 'ArrowRight') activate((idx + 1) % tabs.length, true);
                    else if (e.key === 'ArrowLeft') activate((idx - 1 + tabs.length) % tabs.length, true);
                    else if (e.key === 'Home') activate(0, true);
                    else if (e.key === 'End') activate(tabs.length - 1, true);
                });
            });

            var start = 0;
            try { var stored = parseInt(localStorage.getItem(storageKey), 10); if (!isNaN(stored) && stored >= 0 && stored < tabs.length) start = stored; } catch (e) {}
            activate(start, false);
        })();

        // Karten-Konfiguration
        var places = {
            'map-mainz':     { lat: 49.992861, lng: 8.247253, title: 'Mainz' },
            'map-frankfurt': { lat: 50.110924, lng: 8.682127, title: 'Frankfurt am Main' },
            'map-hanau':     { lat: 50.131900, lng: 8.916100, title: 'Hanau' }
        };

        var tileUrl = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
        var attribution = '&copy; OpenStreetMap contributors';

        Object.keys(places).forEach(function (id) {
            var el = document.getElementById(id);
            if (!el) return;

            // Leere Inhalte (falls mehrfach initialisiert)
            el.innerHTML = '';

            var cfg = places[id];
            var map = L.map(el, { scrollWheelZoom: false }).setView([cfg.lat, cfg.lng], 12);
            L.tileLayer(tileUrl, { attribution: attribution }).addTo(map);
            L.marker([cfg.lat, cfg.lng]).addTo(map).bindPopup(cfg.title);

            // Wenn die Karte versteckt war, sorgt invalidateSize für korrekte Darstellung
            setTimeout(function () { map.invalidateSize(); }, 250);
        });

        // Theme Toggle
        (function initTheme() {
            var btn = document.getElementById('theme-toggle');
            var root = document.documentElement;
            var storageKey = 'theme-mode';

            function apply(mode) {
                if (mode === 'dark') {
                    root.classList.add('dark');
                    btn.dataset.mode = 'dark';
                    btn.innerText = '☀️ Hell';
                    btn.setAttribute('aria-pressed', 'true');
                } else {
                    root.classList.remove('dark');
                    btn.dataset.mode = 'light';
                    btn.innerText = '🌙 Dunkel';
                    btn.setAttribute('aria-pressed', 'false');
                }
            }

            function getPreferred() {
                var stored = localStorage.getItem(storageKey);
                if (stored === 'dark' || stored === 'light') return stored;
                return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            }

            apply(getPreferred());

            btn.addEventListener('click', function () {
                var next = btn.dataset.mode === 'dark' ? 'light' : 'dark';
                apply(next);
                try { localStorage.setItem(storageKey, next); } catch (e) {}
            });

            if (window.matchMedia) {
                var mq = window.matchMedia('(prefers-color-scheme: dark)');
                if (mq.addEventListener) mq.addEventListener('change', function (e) { if (!localStorage.getItem(storageKey)) apply(e.matches ? 'dark' : 'light'); });
                else if (mq.addListener) mq.addListener(function (e) { if (!localStorage.getItem(storageKey)) apply(e.matches ? 'dark' : 'light'); });
            }
        })();

        // Dynamisches Laden der News aus assets/news.json
        function loadNews() {
            var container = document.getElementById('news-list');
            if (!container) return;

            fetch('assets/news.json', { cache: 'no-store' })
                .then(function (res) {
                    if (!res.ok) throw new Error('Netzwerkfehler');
                    return res.json();
                })
                .then(function (items) {
                    container.innerHTML = '';
                    if (!items || !items.length) {
                        container.innerHTML = '<p style="color:var(--muted);">Derzeit keine Meldungen.</p>';
                        return;
                    }

                    items.forEach(function (it) {
                        var article = document.createElement('article');
                        article.className = 'card';
                        article.setAttribute('role', 'article');

                        var imgHtml = '';
                        if (it.image) {
                            imgHtml = '<img src="' + encodeURI(it.image) + '" alt="' + (it.title ? it.title : '') + '" style="width:100%;height:120px;object-fit:cover;">';
                        }

                        var dateStr = it.date ? (new Date(it.date)).toLocaleDateString('de-DE', { year: 'numeric', month: 'long', day: 'numeric' }) : '';

                        article.innerHTML = '\n                            ' + imgHtml + '\n                            <div class="card-content">\n                                <h3>' + (it.title || '') + '</h3>\n                                <time datetime="' + (it.date || '') + '" style="display:block;color:var(--muted);font-size:.9rem;margin-bottom:.35rem;">' + dateStr + '</time>\n                                <p style="margin:0;color:var(--muted);">' + (it.excerpt || '') + '</p>\n                            </div>';

                        container.appendChild(article);
                    });
                })
                .catch(function (err) {
                    container.innerHTML = '<p style="color:var(--muted);">Fehler beim Laden der Meldungen.</p>';
                    console.error('News load failed', err);
                });
        }

        // News laden (einmal nach DOMContentLoaded)
        loadNews();

    });
    </script>
</body>
</html>